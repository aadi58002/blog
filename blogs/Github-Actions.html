<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Github Actions For void linux | Aditya Yadav</title>
    <meta name="description" content="Explaining how i understand github actions">
    <meta name="generator" content="VitePress v1.3.4">
    <link rel="preload stylesheet" href="/blog/assets/style.BbRK5VyC.css" as="style">
    
    <script type="module" src="/blog/assets/app.IXZpZ4Q2.js"></script>
    <link rel="modulepreload" href="/blog/assets/chunks/theme.DScgP8mf.js">
    <link rel="modulepreload" href="/blog/assets/chunks/framework.CMFhz-x3.js">
    <link rel="modulepreload" href="/blog/assets/blogs_Github-Actions.md.Dtfz760s.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-c59989c4><!--[--><!--]--><!--[--><span tabindex="-1" data-v-eead19f4></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-eead19f4> Skip to content </a><!--]--><!----><header class="VPNav" data-v-c59989c4 data-v-422fe837><div class="VPNavBar has-sidebar top" data-v-422fe837 data-v-55c3b1d9><div class="wrapper" data-v-55c3b1d9><div class="container" data-v-55c3b1d9><div class="title" data-v-55c3b1d9><div class="VPNavBarTitle has-sidebar" data-v-55c3b1d9 data-v-46467263><a class="title" href="/blog/" data-v-46467263><!--[--><!--]--><!----><span data-v-46467263>Aditya Yadav</span><!--[--><!--]--></a></div></div><div class="content" data-v-55c3b1d9><div class="content-body" data-v-55c3b1d9><!--[--><!--]--><div class="VPNavBarSearch search" data-v-55c3b1d9><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-55c3b1d9 data-v-40648a24><span id="main-nav-aria-label" class="visually-hidden" data-v-40648a24> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog/" tabindex="0" data-v-40648a24 data-v-0ccbe79a><!--[--><span data-v-0ccbe79a>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog/blogs/" tabindex="0" data-v-40648a24 data-v-0ccbe79a><!--[--><span data-v-0ccbe79a>Blogs</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog/resources/" tabindex="0" data-v-40648a24 data-v-0ccbe79a><!--[--><span data-v-0ccbe79a>Resources</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog/contact/" tabindex="0" data-v-40648a24 data-v-0ccbe79a><!--[--><span data-v-0ccbe79a>Contact</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-55c3b1d9 data-v-998e5934><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-998e5934 data-v-37e4afc7 data-v-0672c7d2><span class="check" data-v-0672c7d2><span class="icon" data-v-0672c7d2><!--[--><span class="vpi-sun sun" data-v-37e4afc7></span><span class="vpi-moon moon" data-v-37e4afc7></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-55c3b1d9 data-v-b0bff452 data-v-4ea057ee><!--[--><a class="VPSocialLink no-icon" href="https://github.com/aadi58002/blog.git" aria-label="github" target="_blank" rel="noopener" data-v-4ea057ee data-v-39978add><span class="vpi-social-github" /></a><a class="VPSocialLink no-icon" href="https://github.com/aadi58002/Linux-Blog.git" aria-label target="_blank" rel="noopener" data-v-4ea057ee data-v-39978add><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" data-supported-dps="24x24" fill="currentColor" class="mercado-match" width="24" height="24" focusable="false"><path d="M20.5 2h-17A1.5 1.5 0 002 3.5v17A1.5 1.5 0 003.5 22h17a1.5 1.5 0 001.5-1.5v-17A1.5 1.5 0 0020.5 2zM8 19H5v-9h3zM6.5 8.25A1.75 1.75 0 118.3 6.5a1.78 1.78 0 01-1.8 1.75zM19 19h-3v-4.74c0-1.42-.6-1.93-1.38-1.93A1.74 1.74 0 0013 14.19a.66.66 0 000 .14V19h-3v-9h2.9v1.3a3.11 3.11 0 012.7-1.4c1.55 0 3.36.86 3.36 3.66z"></path></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-55c3b1d9 data-v-21cac0f9 data-v-d4a94e6b><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-d4a94e6b><span class="vpi-more-horizontal icon" data-v-d4a94e6b></span></button><div class="menu" data-v-d4a94e6b><div class="VPMenu" data-v-d4a94e6b data-v-97932312><!----><!--[--><!--[--><!----><div class="group" data-v-21cac0f9><div class="item appearance" data-v-21cac0f9><p class="label" data-v-21cac0f9>Appearance</p><div class="appearance-action" data-v-21cac0f9><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-21cac0f9 data-v-37e4afc7 data-v-0672c7d2><span class="check" data-v-0672c7d2><span class="icon" data-v-0672c7d2><!--[--><span class="vpi-sun sun" data-v-37e4afc7></span><span class="vpi-moon moon" data-v-37e4afc7></span><!--]--></span></span></button></div></div></div><div class="group" data-v-21cac0f9><div class="item social-links" data-v-21cac0f9><div class="VPSocialLinks social-links-list" data-v-21cac0f9 data-v-4ea057ee><!--[--><a class="VPSocialLink no-icon" href="https://github.com/aadi58002/blog.git" aria-label="github" target="_blank" rel="noopener" data-v-4ea057ee data-v-39978add><span class="vpi-social-github" /></a><a class="VPSocialLink no-icon" href="https://github.com/aadi58002/Linux-Blog.git" aria-label target="_blank" rel="noopener" data-v-4ea057ee data-v-39978add><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" data-supported-dps="24x24" fill="currentColor" class="mercado-match" width="24" height="24" focusable="false"><path d="M20.5 2h-17A1.5 1.5 0 002 3.5v17A1.5 1.5 0 003.5 22h17a1.5 1.5 0 001.5-1.5v-17A1.5 1.5 0 0020.5 2zM8 19H5v-9h3zM6.5 8.25A1.75 1.75 0 118.3 6.5a1.78 1.78 0 01-1.8 1.75zM19 19h-3v-4.74c0-1.42-.6-1.93-1.38-1.93A1.74 1.74 0 0013 14.19a.66.66 0 000 .14V19h-3v-9h2.9v1.3a3.11 3.11 0 012.7-1.4c1.55 0 3.36.86 3.36 3.66z"></path></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-55c3b1d9 data-v-fd1b31ba><span class="container" data-v-fd1b31ba><span class="top" data-v-fd1b31ba></span><span class="middle" data-v-fd1b31ba></span><span class="bottom" data-v-fd1b31ba></span></span></button></div></div></div></div><div class="divider" data-v-55c3b1d9><div class="divider-line" data-v-55c3b1d9></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-c59989c4 data-v-dd57ed6e><div class="container" data-v-dd57ed6e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-dd57ed6e><span class="vpi-align-left menu-icon" data-v-dd57ed6e></span><span class="menu-text" data-v-dd57ed6e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-dd57ed6e data-v-b2c16584><button data-v-b2c16584>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-c59989c4 data-v-29898f58><div class="curtain" data-v-29898f58></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-29898f58><span class="visually-hidden" id="sidebar-aria-label" data-v-29898f58> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-01702f44><section class="VPSidebarItem level-0 has-active" data-v-01702f44 data-v-396cbf73><div class="item" role="button" tabindex="0" data-v-396cbf73><div class="indicator" data-v-396cbf73></div><h2 class="text" data-v-396cbf73>Blogs</h2><!----></div><div class="items" data-v-396cbf73><!--[--><div class="VPSidebarItem level-1 is-link" data-v-396cbf73 data-v-396cbf73><div class="item" data-v-396cbf73><div class="indicator" data-v-396cbf73></div><a class="VPLink link link" href="/blog/blogs/Vim.html" data-v-396cbf73><!--[--><p class="text" data-v-396cbf73>Vim Tricks</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-396cbf73 data-v-396cbf73><div class="item" data-v-396cbf73><div class="indicator" data-v-396cbf73></div><a class="VPLink link link" href="/blog/blogs/ffi-circle.html" data-v-396cbf73><!--[--><p class="text" data-v-396cbf73>Foreign Function Interface are hard</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-396cbf73 data-v-396cbf73><div class="item" data-v-396cbf73><div class="indicator" data-v-396cbf73></div><a class="VPLink link link" href="/blog/blogs/Rust-Fun-Part-0.html" data-v-396cbf73><!--[--><p class="text" data-v-396cbf73>Rust Fun (Part 0)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-396cbf73 data-v-396cbf73><div class="item" data-v-396cbf73><div class="indicator" data-v-396cbf73></div><a class="VPLink link link" href="/blog/blogs/Rust-Fun-Part-1.html" data-v-396cbf73><!--[--><p class="text" data-v-396cbf73>Rust Fun (Part 1)(Macros)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-396cbf73 data-v-396cbf73><div class="item" data-v-396cbf73><div class="indicator" data-v-396cbf73></div><a class="VPLink link link" href="/blog/blogs/Github-Actions.html" data-v-396cbf73><!--[--><p class="text" data-v-396cbf73>Github Actions For void linux</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-c59989c4 data-v-22146064><div class="VPDoc has-sidebar has-aside" data-v-22146064 data-v-4c8fe2f6><!--[--><!--]--><div class="container" data-v-4c8fe2f6><div class="aside" data-v-4c8fe2f6><div class="aside-curtain" data-v-4c8fe2f6></div><div class="aside-container" data-v-4c8fe2f6><div class="aside-content" data-v-4c8fe2f6><div class="VPDocAside" data-v-4c8fe2f6 data-v-34fae712><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-34fae712 data-v-db6c7673><div class="content" data-v-db6c7673><div class="outline-marker" data-v-db6c7673></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-db6c7673>On this page</div><ul class="VPDocOutlineItem root" data-v-db6c7673 data-v-d7d77e85><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-34fae712></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-4c8fe2f6><div class="content-container" data-v-4c8fe2f6><!--[--><!--]--><main class="main" data-v-4c8fe2f6><div style="position:relative;" class="vp-doc _blog_blogs_Github-Actions" data-v-4c8fe2f6><div><h1 id="frontmatter-title" tabindex="-1">Github Actions For void linux <a class="header-anchor" href="#frontmatter-title" aria-label="Permalink to &quot;{{ $frontmatter.title }}&quot;">​</a></h1><p><img src="/blog/blogs/github-actions-void.png" alt="Banner Image"></p><h2 id="goal" tabindex="-1">Goal <a class="header-anchor" href="#goal" aria-label="Permalink to &quot;Goal&quot;">​</a></h2><p>I wanted to automate the building of package build with <code>xbps-src</code> to a remote automated job and then make it into a <a href="https://docs.voidlinux.org/xbps/repositories/custom.html" target="_blank" rel="noreferrer">repository</a> and host it (for free).</p><p>For summary <a href="https://github.com/void-linux/void-packages" target="_blank" rel="noreferrer">xbps-src</a> is a build system to build packages for void.</p><p>Solution which i found -&gt; Github Actions</p><h2 id="what-is-github-actions" tabindex="-1">What is Github Actions ? <a class="header-anchor" href="#what-is-github-actions" aria-label="Permalink to &quot;What is Github Actions ?&quot;">​</a></h2><p>Github actions are a service provided by github to do blah blah blah... <a href="https://docs.github.com/actions" target="_blank" rel="noreferrer">Read offical wording here</a>.<br> For our use case it is just a computer (Virutal machine) which run commands (mostly bash) declared in files under the <code>.github/workflows</code> folder.</p><p>If you don&#39;t want to read the complete thing and just want the source of automated build -&gt; <a href="https://github.com/aadi58002/void-packages/blob/master/.github/workflows/custom.yaml" target="_blank" rel="noreferrer">here</a> you go.</p><h2 id="why-i-am-doing-this" tabindex="-1">Why i am doing this ? <a class="header-anchor" href="#why-i-am-doing-this" aria-label="Permalink to &quot;Why i am doing this ?&quot;">​</a></h2><p>I have some package which i bundled myself for using on void but they won&#39;t be accepted in the main repo because of strict <a href="https://github.com/void-linux/void-packages/blob/master/CONTRIBUTING.md#package-requirements" target="_blank" rel="noreferrer">guideline</a>.</p><p>Hence to install them i had to compile them myself with <code>xbps-src</code> which is fine and all but i wanted my packages to do just installable with <code>xbps-install</code> from a repository.</p><h2 id="steps-to-achieve-the-goal" tabindex="-1">Steps to achieve the goal <a class="header-anchor" href="#steps-to-achieve-the-goal" aria-label="Permalink to &quot;Steps to achieve the goal&quot;">​</a></h2><ol><li>I want to check which custom package were bundled.</li><li>Build those packages in a CI environment.</li><li>Publish them with github pages as a repository host.</li></ol><h3 id="step-1" tabindex="-1">Step 1 <a class="header-anchor" href="#step-1" aria-label="Permalink to &quot;Step 1&quot;">​</a></h3><p>So in this step I want to identify which packages i bundled myself so that i don&#39;t have to build the entire <a href="https://github.com/void-linux/void-packages/tree/master/srcpkgs" target="_blank" rel="noreferrer">void-packages</a>.</p><p>Conveniently there are a lot of scripts inside <code>common/travis/</code> folder to make working in ci with void-packages very easy.</p><p>Let search through and find something which might help us. -&gt; <a href="https://github.com/void-linux/void-packages/blob/master/common/travis/changed_templates.sh" target="_blank" rel="noreferrer">Changed Templates</a></p><p>Let see if we can find intersting thing in this script and make it fit our usecase.</p><h4 id="lets-see-what-it-does" tabindex="-1">Lets see what it does. <a class="header-anchor" href="#lets-see-what-it-does" aria-label="Permalink to &quot;Lets see what it does.&quot;">​</a></h4><ul><li>This part seems to get the last commit in git which is not a merge commit and then save it to the tip variable.</li></ul><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#!/bin/sh</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># changed_templates.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rev-list </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --parents</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> HEAD)&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">case</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$tip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> in</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	# This is a merge commit, pick last parent</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot; &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot; &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">)</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">##*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> }&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ;;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	# This is a non-merge commit, pick itself</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	*)</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">         tip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">%%</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ;;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">esac</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><br><ul><li>This seems to get the last commit where you merged the main <code>void-linux/void-packages</code> repo into your personal branch.<details class="details custom-block"><summary>Details</summary><p>I didn&#39;t knew about <a href="https://linux.die.net/man/1/git-merge-base" target="_blank" rel="noreferrer">merge-base</a> command before this so we learn something new this time around</p></details></li></ul><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># You can run `man git-merge-base` to get a good idea of what it does ( it also has some diagrams )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">base</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> merge-base origin/HEAD &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$tip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;)&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[ $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rev-list</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --count</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$tip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;^</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$base</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-lt</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;::error title=Branch out of date::Your branch is too out of date. Please rebase on upstream and force-push.&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	exit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><br><ul><li>Finally at the last part of the script it print outs all the name of the changed template in <code>srcpkgs</code> folder between the merge_base and the last non merge commit.<details class="details custom-block"><summary>Details</summary><ul><li>It uses cut to get the package name specifically from the path name like <code>srcpkgs/emacs/template</code> to <code>emacs</code>.</li><li>Note it uses tee to output both to the terminal screen (stdout) and to a file <code>/tmp/templates</code>.</li></ul></details></li></ul><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$base</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $tip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/tmp/revisions</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/bin/echo</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;\x1b[32mChanged packages:\x1b[0m&#39;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> diff-tree</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --no-renames</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --name-only</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --diff-filter=AM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">	&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$base</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$tip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;srcpkgs/*/template&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	cut</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	tee</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /tmp/templates</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	sed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;s/^/  /&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;&amp;2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><br><ul><li>What changes did i make to the script Lets see i don&#39;t usually merge the main repo into my personal one.<br> I just rebase my commit from the latest commit from the <a href="https://github.com/void-linux/void-packages" target="_blank" rel="noreferrer">upstream</a> with command <code>git pull --rebase upstream master</code>.<div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Rebase advantage over merge:-</p><ul><li>No seperate commit for the merge.</li><li>Make it easier to identify which file you have changed.</li></ul></div></li></ul><p>Add the script assumes that the origin remote is the <a href="https://github.com/void-linux/void-packages" target="_blank" rel="noreferrer">main repo</a> but i have it under upstream. So just a little change of name and it is done.</p><div class="language-diff vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">diff</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;">- base=&quot;$(git merge-base origin/HEAD $tip)&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">+ base=&quot;$(git merge-base upstream/master $tip)&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="step-2" tabindex="-1">Step 2 <a class="header-anchor" href="#step-2" aria-label="Permalink to &quot;Step 2&quot;">​</a></h3><p>This part was the part which i though would be the hardest but looking in the folder for workflow in the <a href="https://github.com/void-linux/void-packages" target="_blank" rel="noreferrer">main repo</a>.<br> I found the a build workflow for the package and there environment setup -&gt; <a href="https://github.com/void-linux/void-packages/blob/master/.github/workflows/build.yaml" target="_blank" rel="noreferrer">build.yaml</a> So we copy paste the part we want and try to understand whats going on.</p><h4 id="name" tabindex="-1">Name <a class="header-anchor" href="#name" aria-label="Permalink to &quot;Name&quot;">​</a></h4><p>It is basically the name of the Action which is shown under the <a href="https://github.com/aadi58002/void-packages/actions" target="_blank" rel="noreferrer">Github Actions page</a>.</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Build Custom package</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h4 id="trigger" tabindex="-1">Trigger <a class="header-anchor" href="#trigger" aria-label="Permalink to &quot;Trigger&quot;">​</a></h4><p>Triggers are conditionals which tells github when to run a job.<br><a href="https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows" target="_blank" rel="noreferrer">All github actions triggers</a><br> You can see two triggers here.</p><ul><li>workflow_dispatch -&gt; It gives you <code>run workflow</code> button you see below to manually trigger the action. <img src="/blog/blogs/github-workflow-dispatch.png" alt="Banner Image"></li><li>push.paths -&gt; Trigger the actions whenever a commit is pushed which changed the file under <code>srcpkgs</code> path.</li></ul><details class="details custom-block"><summary>Details</summary><p><code>srcpkgs/**</code> - The <code>**</code> here are called glob in bash. You can read more about it here <a href="https://linuxhint.com/bash_globbing_tutorial/" target="_blank" rel="noreferrer">Bash Globbing Tutorial</a></p></details><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  workflow_dispatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    paths</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;srcpkgs/**&#39;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="creating-a-job" tabindex="-1">Creating a Job <a class="header-anchor" href="#creating-a-job" aria-label="Permalink to &quot;Creating a Job&quot;">​</a></h4><p>Here is the thing you all been waiting for this is where we write the steps to do thing we want to do like build packages. You can read the below like. Run the job build in the ubuntu-latest Virtual machine.</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">jobs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    runs-on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ubuntu-latest</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="attach-a-container-with-void-tools" tabindex="-1">Attach a Container with void tools <a class="header-anchor" href="#attach-a-container-with-void-tools" aria-label="Permalink to &quot;Attach a Container with void tools&quot;">​</a></h4></div></div></main><footer class="VPDocFooter" data-v-4c8fe2f6 data-v-cbc0fe14><!--[--><!--]--><div class="edit-info" data-v-cbc0fe14><div class="edit-link" data-v-cbc0fe14><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/aadi58002/blog/edit/main/content/blogs/Github-Actions.md" target="_blank" rel="noreferrer" data-v-cbc0fe14><!--[--><span class="vpi-square-pen edit-link-icon" data-v-cbc0fe14></span> Edit this page<!--]--></a></div><div class="last-updated" data-v-cbc0fe14><p class="VPLastUpdated" data-v-cbc0fe14 data-v-c8ba5516>Updated Date: <time datetime="2024-09-20T14:56:59.000Z" data-v-c8ba5516></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-cbc0fe14><span class="visually-hidden" id="doc-footer-aria-label" data-v-cbc0fe14>Pager</span><div class="pager" data-v-cbc0fe14><a class="VPLink link pager-link prev" href="/blog/blogs/Rust-Fun-Part-1.html" data-v-cbc0fe14><!--[--><span class="desc" data-v-cbc0fe14>Previous page</span><span class="title" data-v-cbc0fe14>Rust Fun (Part 1)(Macros)</span><!--]--></a></div><div class="pager" data-v-cbc0fe14><!----></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"blogs_ffi-circle.md\":\"BKfB16br\",\"blogs_github-actions.md\":\"Dtfz760s\",\"blogs_index.md\":\"C1k53ZPN\",\"blogs_rust-fun-part-0.md\":\"D3PbJGhr\",\"blogs_rust-fun-part-1.md\":\"CN1zLCao\",\"blogs_vim.md\":\"CkVm8aDm\",\"contact_index.md\":\"DENUM89w\",\"index.md\":\"DVT9ZGYS\",\"resources_index.md\":\"BCnQQDCJ\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Aditya Yadav\",\"description\":\"Interting topics as well a place to get good resources for topics of my interest\",\"base\":\"/blog/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"search\":{\"provider\":\"local\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/aadi58002/blog.git\"},{\"icon\":{\"svg\":\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 24 24\\\" data-supported-dps=\\\"24x24\\\" fill=\\\"currentColor\\\" class=\\\"mercado-match\\\" width=\\\"24\\\" height=\\\"24\\\" focusable=\\\"false\\\"><path d=\\\"M20.5 2h-17A1.5 1.5 0 002 3.5v17A1.5 1.5 0 003.5 22h17a1.5 1.5 0 001.5-1.5v-17A1.5 1.5 0 0020.5 2zM8 19H5v-9h3zM6.5 8.25A1.75 1.75 0 118.3 6.5a1.78 1.78 0 01-1.8 1.75zM19 19h-3v-4.74c0-1.42-.6-1.93-1.38-1.93A1.74 1.74 0 0013 14.19a.66.66 0 000 .14V19h-3v-9h2.9v1.3a3.11 3.11 0 012.7-1.4c1.55 0 3.36.86 3.36 3.66z\\\"></path></svg>\"},\"link\":\"https://github.com/aadi58002/Linux-Blog.git\"}],\"editLink\":{\"pattern\":\"https://github.com/aadi58002/blog/edit/main/content/:path\"},\"lastUpdatedText\":\"Updated Date\",\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Blogs\",\"link\":\"/blogs/\"},{\"text\":\"Resources\",\"link\":\"/resources/\"},{\"text\":\"Contact\",\"link\":\"/contact/\"}],\"sidebar\":{\"/blogs/\":[{\"text\":\"Blogs\",\"collapsible\":true,\"Uniqtags\":[\"Rust\",\"Text Editor\",\"Automation\",\"Build systems\",\"Programming\",\"Fun\",\"Projects\",\"Github\",\"Vim\",\"FFI\"],\"items\":[{\"link\":\"/blogs/Vim\",\"text\":\"Vim Tricks\",\"description\":\"A set of vim command which can be useful but are not commonly found\",\"tags\":[\"Text Editor\",\"Vim\"],\"lastUpdated\":\"2024-09-20\"},{\"link\":\"/blogs/ffi-circle\",\"text\":\"Foreign Function Interface are hard\",\"description\":\"A fun learning project to learn about ffi between languages and tooling around them\",\"tags\":[\"Programming\",\"Fun\",\"FFI\"],\"lastUpdated\":\"2024-09-20\"},{\"link\":\"/blogs/Rust-Fun-Part-0\",\"text\":\"Rust Fun (Part 0)\",\"description\":\"Some fun activities to try out with rust\",\"tags\":[\"Rust\",\"Projects\",\"Fun\"],\"lastUpdated\":\"2024-09-20\"},{\"link\":\"/blogs/Rust-Fun-Part-1\",\"text\":\"Rust Fun (Part 1)(Macros)\",\"description\":\"The first part of fun tasks planned for the Rust fun series\",\"tags\":[\"Rust\",\"Projects\",\"Fun\"],\"lastUpdated\":\"2024-09-20\"},{\"link\":\"/blogs/Github-Actions\",\"text\":\"Github Actions For void linux\",\"description\":\"Explaining how i understand github actions\",\"tags\":[\"Github\",\"Automation\",\"Build systems\"],\"lastUpdated\":\"2024-09-20\"}]}]}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>